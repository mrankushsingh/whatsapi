<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation - WhatsApp Group Link Scraper</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container my-5">
        <div class="row">
            <div class="col-lg-3">
                <!-- Navigation -->
                <nav class="sticky-top">
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-title">Navigation</h6>
                            <ul class="nav nav-pills flex-column">
                                <li class="nav-item">
                                    <a class="nav-link" href="#overview">Overview</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#authentication">Authentication</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#endpoints">Endpoints</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#errors">Error Handling</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#examples">Examples</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#rate-limits">Rate Limits</a>
                                </li>
                            </ul>
                            <hr>
                            <a href="/" class="btn btn-outline-primary btn-sm">
                                <i data-feather="arrow-left" class="me-1"></i>
                                Back to Home
                            </a>
                        </div>
                    </div>
                </nav>
            </div>
            
            <div class="col-lg-9">
                <!-- Header -->
                <div class="mb-5">
                    <h1 class="display-5">
                        <i data-feather="book" class="me-3"></i>
                        API Documentation
                    </h1>
                    <p class="lead text-muted">
                        Complete reference for the WhatsApp Group Link Scraper API
                    </p>
                </div>

                <!-- Overview -->
                <section id="overview" class="mb-5">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="h4 mb-3">
                                <i data-feather="info" class="me-2"></i>
                                Overview
                            </h2>
                            <p>
                                The WhatsApp Group Link Scraper API allows you to extract metadata from WhatsApp group invite links. 
                                The API uses rotating proxies to ensure reliable access and returns Open Graph metadata including 
                                group titles and images.
                            </p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Base URL</h6>
                                    <code>{{ request.url_root }}</code>
                                </div>
                                <div class="col-md-6">
                                    <h6>Response Format</h6>
                                    <code>JSON</code>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Authentication -->
                <section id="authentication" class="mb-5">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="h4 mb-3">
                                <i data-feather="shield" class="me-2"></i>
                                Authentication
                            </h2>
                            <p>
                                This API currently does not require authentication. All endpoints are publicly accessible.
                            </p>
                            <div class="alert alert-info" role="alert">
                                <i data-feather="info" class="me-2"></i>
                                <strong>Note:</strong> Rate limiting may be applied to prevent abuse. See the Rate Limits section for details.
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Endpoints -->
                <section id="endpoints" class="mb-5">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="h4 mb-3">
                                <i data-feather="terminal" class="me-2"></i>
                                Endpoints
                            </h2>

                            <!-- Health Check -->
                            <div class="mb-4">
                                <h5><span class="badge bg-success me-2">GET</span>/health</h5>
                                <p>Check the API health status.</p>
                                
                                <h6>Response</h6>
                                <pre class="bg-dark p-3 rounded"><code>{
  "status": "healthy",
  "message": "WhatsApp Group Link Scraper API is running",
  "version": "1.0.0"
}</code></pre>
                            </div>

                            <!-- Scrape Endpoint -->
                            <div class="mb-4">
                                <h5><span class="badge bg-primary me-2">POST</span>/scrape</h5>
                                <p>Scrape metadata from a WhatsApp group invite link.</p>
                                
                                <h6>Request Body</h6>
                                <pre class="bg-dark p-3 rounded"><code>{
  "link": "https://chat.whatsapp.com/XXXXXXXXX"
}</code></pre>

                                <h6>Parameters</h6>
                                <table class="table table-dark table-striped">
                                    <thead>
                                        <tr>
                                            <th>Parameter</th>
                                            <th>Type</th>
                                            <th>Required</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>link</td>
                                            <td>string</td>
                                            <td>Yes</td>
                                            <td>WhatsApp group invite link starting with "https://chat.whatsapp.com/"</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h6>Success Response (200 OK)</h6>
                                <pre class="bg-dark p-3 rounded"><code>{
  "og_title": "My Awesome Group",
  "og_image": "https://example.com/group-image.jpg",
  "og_description": "Join our awesome group!",
  "og_url": "https://chat.whatsapp.com/XXXXXXXXX",
  "link": "https://chat.whatsapp.com/XXXXXXXXX"
}</code></pre>

                                <h6>Error Response (400 Bad Request)</h6>
                                <pre class="bg-dark p-3 rounded"><code>{
  "error": "Link must be a valid WhatsApp group invite link starting with 'https://chat.whatsapp.com/'"
}</code></pre>

                                <h6>Error Response (500 Internal Server Error)</h6>
                                <pre class="bg-dark p-3 rounded"><code>{
  "error": "Unable to scrape the link after 3 attempts. All proxies failed or the link may be inaccessible."
}</code></pre>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Error Handling -->
                <section id="errors" class="mb-5">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="h4 mb-3">
                                <i data-feather="alert-triangle" class="me-2"></i>
                                Error Handling
                            </h2>
                            <p>The API uses standard HTTP status codes to indicate success or failure:</p>
                            
                            <table class="table table-dark table-striped">
                                <thead>
                                    <tr>
                                        <th>Status Code</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="badge bg-success">200</span></td>
                                        <td>Success - Request completed successfully</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-warning">400</span></td>
                                        <td>Bad Request - Invalid or missing parameters</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-secondary">404</span></td>
                                        <td>Not Found - Endpoint does not exist</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-secondary">405</span></td>
                                        <td>Method Not Allowed - HTTP method not supported</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-danger">500</span></td>
                                        <td>Internal Server Error - Server-side error occurred</td>
                                    </tr>
                                </tbody>
                            </table>

                            <p>All error responses include a JSON object with an <code>error</code> field describing the issue.</p>
                        </div>
                    </div>
                </section>

                <!-- Examples -->
                <section id="examples" class="mb-5">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="h4 mb-3">
                                <i data-feather="code" class="me-2"></i>
                                Examples
                            </h2>

                            <!-- cURL Example -->
                            <div class="mb-4">
                                <h5>cURL</h5>
                                <pre class="bg-dark p-3 rounded"><code>curl -X POST {{ request.url_root }}scrape \
  -H "Content-Type: application/json" \
  -d '{
    "link": "https://chat.whatsapp.com/XXXXXXXXX"
  }'</code></pre>
                            </div>

                            <!-- JavaScript Example -->
                            <div class="mb-4">
                                <h5>JavaScript (Fetch API)</h5>
                                <pre class="bg-dark p-3 rounded"><code>const response = await fetch('{{ request.url_root }}scrape', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    link: 'https://chat.whatsapp.com/XXXXXXXXX'
  })
});

const data = await response.json();
console.log(data);</code></pre>
                            </div>

                            <!-- Python Example -->
                            <div class="mb-4">
                                <h5>Python (requests)</h5>
                                <pre class="bg-dark p-3 rounded"><code>import requests

url = '{{ request.url_root }}scrape'
data = {
    'link': 'https://chat.whatsapp.com/XXXXXXXXX'
}

response = requests.post(url, json=data)
result = response.json()
print(result)</code></pre>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Rate Limits -->
                <section id="rate-limits" class="mb-5">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="h4 mb-3">
                                <i data-feather="clock" class="me-2"></i>
                                Rate Limits & Best Practices
                            </h2>
                            <p>To ensure fair usage and optimal performance:</p>
                            <ul>
                                <li>Implement reasonable delays between requests</li>
                                <li>Cache results when possible to avoid duplicate requests</li>
                                <li>Handle error responses gracefully with exponential backoff</li>
                                <li>Validate WhatsApp links client-side before making API calls</li>
                            </ul>
                            
                            <div class="alert alert-warning" role="alert">
                                <i data-feather="alert-triangle" class="me-2"></i>
                                <strong>Important:</strong> Some WhatsApp group links may be rate-limited or blocked by WhatsApp itself. 
                                The API will attempt to scrape using multiple proxies but may still fail for certain links.
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js"></script>
    <script>
        // Initialize Feather icons
        feather.replace();

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Highlight active navigation item
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link[href^="#"]');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
